{{ define "title" }}Analytics â€” {{ .ShortCode }}{{ end }}

{{ define "content" }}
<h1 class="text-3xl font-bold mb-4">Analytics for <span class="font-mono">{{ .ShortCode }}</span></h1>

<div class="bg-white p-4 rounded shadow mb-6">
  <p class="mb-1"><strong>Short URL:</strong>
    <a class="text-blue-600 break-all" href="{{ printf "%s/%s" .AppDomain .ShortCode }}" target="_blank" rel="noopener">{{ printf "%s/%s" .AppDomain .ShortCode }}</a>
  </p>
  <p class="mb-1"><strong>Destination:</strong> <span class="break-all">{{ .LongURL }}</span></p>
  <p class="mb-0"><strong>Total Clicks:</strong> <span id="total-clicks">{{ .ClickCount }}</span></p>

  <div class="mt-3 flex gap-2">
    <button class="px-3 py-1 bg-gray-100 rounded" onclick="navigator.clipboard.writeText((document.querySelector('a').href))">Copy Link</button>
    <a href="{{ printf "/%s+" .ShortCode }}" class="px-3 py-1 bg-blue-600 text-white rounded">View Full Stats</a>
  </div>
</div>

<!-- Auto refresh stats content every 5 seconds (HTMX) -->
<div
  hx-get="{{ printf "/stats/%s" .ShortCode }}"
  hx-trigger="load, every 5s"
  hx-target="#stats"
  hx-swap="outerHTML"
  class="htmx-request"
></div>

<div id="stats" aria-live="polite"></div>

{{ end }}

{{ template "base" . }}
